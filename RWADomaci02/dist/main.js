(()=>{"use strict";var e;!function(e){e[e.stopped=0]="stopped",e[e.running=1]="running"}(e||(e={}));const t=new class{constructor(e){this.name=e,this.score=0,this.topScore=0,this.lives=3}evaluateTopScore(){0==this.lives&&this.score>=this.topScore&&(this.topScore=this.score)}increaseScore(e){this.score+=e}reset(){this.lives=3,this.score=0}}("Strahinja"),s=new class{constructor(t,s,i,a){this.size=t,this.tiles=new Array,this.difficulty=s,this.speed=i,this.player=a,this.currentLevel=1,this.gameState=e.stopped,this.currentTile=0}evaluate(e){return this.tiles[this.currentTile]!==e?(this.player.lives--,this.currentTile=0,0===this.player.lives?(this.end(),-2):-1):(this.currentTile++,this.player.increaseScore(5),this.currentTile===this.currentLevel?(this.nextRound(),1):0)}generateARandomTile(){const e=Math.round(Math.random()*this.size*this.size)%(this.size*this.size);return this.tiles.push(e),this.tiles}start(){if(this.gameState===e.stopped)return this.reset(),this.gameState=e.running,this.generateARandomTile()}reset(){this.tiles=new Array,this.player.reset()}nextRound(){this.currentLevel++,this.currentTile=0,this.generateARandomTile()}end(){this.player.evaluateTopScore(),this.reset()}}(3,10,5,t);new class{constructor(e,t){this.model=t,this.container=e}draw(){for(let e=0;e<this.model.size;e++){const t=document.createElement("div");t.className="Row",this.container.appendChild(t);for(let s=0;s<this.model.size;s++){const i=document.createElement("button");i.className="Tile",i.id=`Button${e*this.model.size+s}`,i.onclick=async()=>{this.evaluate(i,e*this.model.size+s)},t.appendChild(i)}}const e=document.createElement("button");e.innerHTML="Start",e.className="Start",e.onclick=()=>{e.disabled=!0,this.interactableTiles("true"),this.initiateGame()},this.container.appendChild(e);const t=document.createElement("div");t.className="PlayerInfo";const s=document.createElement("label");s.innerHTML=this.model.player.name,s.className="PlayerName",t.appendChild(s);const i=document.createElement("label");i.innerHTML=this.model.player.score.toString(),i.className="PlayerScore",t.appendChild(i);const a=document.createElement("label");a.innerHTML=this.model.player.topScore.toString(),a.className="PlayerTopScore",t.appendChild(a);const l=document.createElement("label");l.innerHTML=this.model.player.lives.toString(),l.className="PlayerLives",t.appendChild(l),this.container.appendChild(t)}async sleep(e){return new Promise((t=>setTimeout(t,e)))}async initiateGame(){const e=this.model.start();console.log(e),await this.sleep(1e3),e.forEach((async e=>{await this.showTile(document.getElementById(`Button${e}`))}))}async showTile(e){return new Promise(((t,s)=>{e.classList.add("ActiveTile"),setTimeout((async()=>{e.classList.remove("ActiveTile"),await this.sleep(500),t(null)}),500)}))}async evaluate(e,t){switch(await this.showTile(e),this.model.evaluate(t)){case-2:document.querySelector(".Start").setAttribute("enabled","true"),this.interactableTiles("false");case-1:await this.levelNotCleared(),await this.displayPattern();break;case 0:break;case 1:await this.levelCleared(),await this.displayPattern()}this.updatePlayerInfo()}async displayPattern(){const e=this.model.tiles;console.log(e),await this.sleep(2e3);for(const t of e)await this.showTile(document.getElementById(`Button${t}`))}interactableTiles(e){document.querySelectorAll(".Tile").forEach((t=>t.setAttribute("enabled",e)))}updatePlayerInfo(){document.querySelector(".PlayerScore").innerHTML=this.model.player.score.toString(),document.querySelector(".PlayerTopScore").innerHTML=this.model.player.topScore.toString(),document.querySelector(".PlayerLives").innerHTML=this.model.player.lives.toString()}async levelCleared(){await this.sleep(500);const e=document.querySelectorAll(".Tile");e.forEach((e=>e.classList.add("Cleared"))),await this.sleep(1e3),e.forEach((e=>e.classList.remove("Cleared")))}async levelNotCleared(){await this.sleep(500);const e=document.querySelectorAll(".Tile");e.forEach((e=>e.classList.add("NotCleared"))),await this.sleep(1e3),e.forEach((e=>e.classList.remove("NotCleared")))}}(document.body,s).draw(),console.log("succ")})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9yd2Fkb21hY2kwMi8uL3NyYy9tZW1vcnlnYW1lbW9kZWwudHMiLCJ3ZWJwYWNrOi8vcndhZG9tYWNpMDIvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vcndhZG9tYWNpMDIvLi9zcmMvcGxheWVybW9kZWwudHMiLCJ3ZWJwYWNrOi8vcndhZG9tYWNpMDIvLi9zcmMvbWVtb3J5Z2FtZXZpZXcudHMiXSwibmFtZXMiOlsiR2FtZVN0YXRlIiwicGxheWVyIiwibmFtZSIsInRoaXMiLCJzY29yZSIsInRvcFNjb3JlIiwibGl2ZXMiLCJwb2ludHMiLCJnYW1lIiwic2l6ZSIsImRpZmZpY3VsdHkiLCJzcGVlZCIsInRpbGVzIiwiQXJyYXkiLCJjdXJyZW50TGV2ZWwiLCJnYW1lU3RhdGUiLCJzdG9wcGVkIiwiY3VycmVudFRpbGUiLCJpbmQiLCJlbmQiLCJpbmNyZWFzZVNjb3JlIiwibmV4dFJvdW5kIiwicmFuZG9tVGlsZSIsIk1hdGgiLCJyb3VuZCIsInJhbmRvbSIsInB1c2giLCJyZXNldCIsInJ1bm5pbmciLCJnZW5lcmF0ZUFSYW5kb21UaWxlIiwiZXZhbHVhdGVUb3BTY29yZSIsImNvbnRhaW5lciIsIm1vZGVsIiwiaSIsInJvdyIsImRvY3VtZW50IiwiY3JlYXRlRWxlbWVudCIsImNsYXNzTmFtZSIsImFwcGVuZENoaWxkIiwiaiIsImJ1dHRvbiIsImlkIiwib25jbGljayIsImFzeW5jIiwiZXZhbHVhdGUiLCJpbm5lckhUTUwiLCJkaXNhYmxlZCIsImludGVyYWN0YWJsZVRpbGVzIiwiaW5pdGlhdGVHYW1lIiwicGxheWVySW5mbyIsInBsYXllck5hbWUiLCJwbGF5ZXJTY29yZSIsInRvU3RyaW5nIiwicGxheWVyVG9wU2NvcmUiLCJwbGF5ZXJMaXZlcyIsIm1zIiwiUHJvbWlzZSIsInJlc29sdmUiLCJzZXRUaW1lb3V0IiwiaW5kZXhlcyIsInN0YXJ0IiwiY29uc29sZSIsImxvZyIsInNsZWVwIiwiZm9yRWFjaCIsImluZGV4Iiwic2hvd1RpbGUiLCJnZXRFbGVtZW50QnlJZCIsInRpbGUiLCJyZWplY3QiLCJjbGFzc0xpc3QiLCJhZGQiLCJyZW1vdmUiLCJxdWVyeVNlbGVjdG9yIiwic2V0QXR0cmlidXRlIiwibGV2ZWxOb3RDbGVhcmVkIiwiZGlzcGxheVBhdHRlcm4iLCJsZXZlbENsZWFyZWQiLCJ1cGRhdGVQbGF5ZXJJbmZvIiwidmFsdWUiLCJxdWVyeVNlbGVjdG9yQWxsIiwiYnV0dG9ucyIsImJvZHkiLCJkcmF3Il0sIm1hcHBpbmdzIjoibUJBQU8sSUFBSUEsR0FDWCxTQUFXQSxHQUNQQSxFQUFVQSxFQUFtQixRQUFJLEdBQUssVUFDdENBLEVBQVVBLEVBQW1CLFFBQUksR0FBSyxVQUYxQyxDQUdHQSxJQUFjQSxFQUFZLEtDRDdCLE1BQU1DLEVBQVMsSUNIUixNQUNILFlBQVlDLEdBQ1JDLEtBQUtELEtBQU9BLEVBQ1pDLEtBQUtDLE1BQVEsRUFDYkQsS0FBS0UsU0FBVyxFQUNoQkYsS0FBS0csTUFBUSxFQUlqQixtQkFDc0IsR0FBZEgsS0FBS0csT0FBY0gsS0FBS0MsT0FBU0QsS0FBS0UsV0FDdENGLEtBQUtFLFNBQVdGLEtBQUtDLE9BSzdCLGNBQWNHLEdBQ1ZKLEtBQUtDLE9BQVNHLEVBRWxCLFFBQ0lKLEtBQUtHLE1BQVEsRUFDYkgsS0FBS0MsTUFBUSxJRGxCVSxhQUN6QkksRUFBTyxJRENOLE1BQ0gsWUFBWUMsRUFBTUMsRUFBWUMsRUFBT1YsR0FDakNFLEtBQUtNLEtBQU9BLEVBQ1pOLEtBQUtTLE1BQVEsSUFBSUMsTUFDakJWLEtBQUtPLFdBQWFBLEVBQ2xCUCxLQUFLUSxNQUFRQSxFQUNiUixLQUFLRixPQUFTQSxFQUNkRSxLQUFLVyxhQUFlLEVBQ3BCWCxLQUFLWSxVQUFZZixFQUFVZ0IsUUFDM0JiLEtBQUtjLFlBQWMsRUFFdkIsU0FBU0MsR0FDTCxPQUFJZixLQUFLUyxNQUFNVCxLQUFLYyxlQUFpQkMsR0FDakNmLEtBQUtGLE9BQU9LLFFBQ1pILEtBQUtjLFlBQWMsRUFDTyxJQUF0QmQsS0FBS0YsT0FB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S0FDakIsTUFBTWtCLEVBQVU5QyxTQUFTNkMsaUJBQWlCLFNBQzFDQyxFQUFRakIsU0FBU3hCLEdBQVdBLEVBQU84QixVQUFVQyxJQUFJLG1CQUMzQ3BFLEtBQUs0RCxNQUFNLEtBQ2pCa0IsRUFBUWpCLFNBQVN4QixHQUFXQSxFQUFPOEIsVUFBVUUsT0FBTyxhQUV4RCw4QkFDVXJFLEtBQUs0RCxNQUFNLEtBQ2pCLE1BQU1rQixFQUFVOUMsU0FBUzZDLGlCQUFpQixTQUMxQ0MsRUFBUWpCLFNBQVN4QixHQUFXQSxFQUFPOEIsVUFBVUMsSUFBSSxzQkFDM0NwRSxLQUFLNEQsTUFBTSxLQUNqQmtCLEVBQVFqQixTQUFTeEIsR0FBV0EsRUFBTzhCLFVBQVVFLE9BQU8sa0JGN0g1QnJDLFNBQVMrQyxLQUFNMUUsR0FDMUMyRSxPQUNMdEIsUUFBUUMsSUFBSSxTIiwiZmlsZSI6Im1haW4uanMiLCJzb3VyY2VzQ29udGVudCI6WyJleHBvcnQgdmFyIEdhbWVTdGF0ZTtcclxuKGZ1bmN0aW9uIChHYW1lU3RhdGUpIHtcclxuICAgIEdhbWVTdGF0ZVtHYW1lU3RhdGVbXCJzdG9wcGVkXCJdID0gMF0gPSBcInN0b3BwZWRcIjtcclxuICAgIEdhbWVTdGF0ZVtHYW1lU3RhdGVbXCJydW5uaW5nXCJdID0gMV0gPSBcInJ1bm5pbmdcIjtcclxufSkoR2FtZVN0YXRlIHx8IChHYW1lU3RhdGUgPSB7fSkpO1xyXG5leHBvcnQgY2xhc3MgTWVtb3J5R2FtZU1vZGVsIHtcclxuICAgIGNvbnN0cnVjdG9yKHNpemUsIGRpZmZpY3VsdHksIHNwZWVkLCBwbGF5ZXIpIHtcclxuICAgICAgICB0aGlzLnNpemUgPSBzaXplO1xyXG4gICAgICAgIHRoaXMudGlsZXMgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICB0aGlzLmRpZmZpY3VsdHkgPSBkaWZmaWN1bHR5O1xyXG4gICAgICAgIHRoaXMuc3BlZWQgPSBzcGVlZDtcclxuICAgICAgICB0aGlzLnBsYXllciA9IHBsYXllcjtcclxuICAgICAgICB0aGlzLmN1cnJlbnRMZXZlbCA9IDE7XHJcbiAgICAgICAgdGhpcy5nYW1lU3RhdGUgPSBHYW1lU3RhdGUuc3RvcHBlZDtcclxuICAgICAgICB0aGlzLmN1cnJlbnRUaWxlID0gMDtcclxuICAgIH1cclxuICAgIGV2YWx1YXRlKGluZCkge1xyXG4gICAgICAgIGlmICh0aGlzLnRpbGVzW3RoaXMuY3VycmVudFRpbGVdICE9PSBpbmQpIHtcclxuICAgICAgICAgICAgdGhpcy5wbGF5ZXIubGl2ZXMtLTtcclxuICAgICAgICAgICAgdGhpcy5jdXJyZW50VGlsZSA9IDA7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLnBsYXllci5saXZlcyA9PT0gMCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5lbmQoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAtMjtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gLTE7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLmN1cnJlbnRUaWxlKys7XHJcbiAgICAgICAgICAgIHRoaXMucGxheWVyLmluY3JlYXNlU2NvcmUoNSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLmN1cnJlbnRUaWxlID09PSB0aGlzLmN1cnJlbnRMZXZlbCkge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5uZXh0Um91bmQoKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiAxO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiAwO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIGdlbmVyYXRlQVJhbmRvbVRpbGUoKSB7XHJcbiAgICAgICAgY29uc3QgcmFuZG9tVGlsZSA9IE1hdGgucm91bmQoTWF0aC5yYW5kb20oKSAqIHRoaXMuc2l6ZSAqIHRoaXMuc2l6ZSkgJVxyXG4gICAgICAgICAgICAodGhpcy5zaXplICogdGhpcy5zaXplKTtcclxuICAgICAgICB0aGlzLnRpbGVzLnB1c2gocmFuZG9tVGlsZSk7XHJcbiAgICAgICAgcmV0dXJuIHRoaXMudGlsZXM7XHJcbiAgICB9XHJcbiAgICBzdGFydCgpIHtcclxuICAgICAgICBpZiAodGhpcy5nYW1lU3RhdGUgPT09IEdhbWVTdGF0ZS5zdG9wcGVkKSB7XHJcbiAgICAgICAgICAgIHRoaXMucmVzZXQoKTtcclxuICAgICAgICAgICAgdGhpcy5nYW1lU3RhdGUgPSBHYW1lU3RhdGUucnVubmluZztcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuZ2VuZXJhdGVBUmFuZG9tVGlsZSgpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuICAgIHJlc2V0KCkge1xyXG4gICAgICAgIHRoaXMudGlsZXMgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICB0aGlzLnBsYXllci5yZXNldCgpO1xyXG4gICAgfVxyXG4gICAgbmV4dFJvdW5kKCkge1xyXG4gICAgICAgIHRoaXMuY3VycmVudExldmVsKys7XHJcbiAgICAgICAgdGhpcy5jdXJyZW50VGlsZSA9IDA7XHJcbiAgICAgICAgdGhpcy5nZW5lcmF0ZUFSYW5kb21UaWxlKCk7XHJcbiAgICB9XHJcbiAgICBlbmQoKSB7XHJcbiAgICAgICAgdGhpcy5wbGF5ZXIuZXZhbHVhdGVUb3BTY29yZSgpO1xyXG4gICAgICAgIHRoaXMucmVzZXQoKTtcclxuICAgIH1cclxufVxyXG4iLCJpbXBvcnQgeyBQbGF5ZXJNb2RlbCB9IGZyb20gXCIuL3BsYXllcm1vZGVsXCI7XHJcbmltcG9ydCB7IE1lbW9yeUdhbWVNb2RlbCB9IGZyb20gXCIuL21lbW9yeWdhbWVtb2RlbFwiO1xyXG5pbXBvcnQgeyBNZW1vcnlHYW1lVmlldyB9IGZyb20gXCIuL21lbW9yeWdhbWV2aWV3XCI7XHJcbmNvbnN0IHBsYXllciA9IG5ldyBQbGF5ZXJNb2RlbChcIlN0cmFoaW5qYVwiKTtcclxuY29uc3QgZ2FtZSA9IG5ldyBNZW1vcnlHYW1lTW9kZWwoMywgMTAsIDUsIHBsYXllcik7XHJcbmNvbnN0IHZpZXcgPSBuZXcgTWVtb3J5R2FtZVZpZXcoZG9jdW1lbnQuYm9keSwgZ2FtZSk7XHJcbnZpZXcuZHJhdygpO1xyXG5jb25zb2xlLmxvZyhcInN1Y2NcIik7XHJcbiIsImV4cG9ydCBjbGFzcyBQbGF5ZXJNb2RlbCB7XHJcbiAgICBjb25zdHJ1Y3RvcihuYW1lKSB7XHJcbiAgICAgICAgdGhpcy5uYW1lID0gbmFtZTtcclxuICAgICAgICB0aGlzLnNjb3JlID0gMDtcclxuICAgICAgICB0aGlzLnRvcFNjb3JlID0gMDtcclxuICAgICAgICB0aGlzLmxpdmVzID0gMztcclxuICAgIH1cclxuICAgIC8vZGlzcGxheVNjb3JlKHNjb3JlRWxlbWVudDogSFRNTEVsZW1lbnQpOiB2b2lkIHt9XHJcbiAgICAvL2Rpc3BsYXlUb3BTY29yZSh0b3BTY29yZUVsZW1lbnQ6IEhUTUxFbGVtZW50KTogdm9pZCB7fVxyXG4gICAgZXZhbHVhdGVUb3BTY29yZSgpIHtcclxuICAgICAgICBpZiAodGhpcy5saXZlcyA9PSAwICYmIHRoaXMuc2NvcmUgPj0gdGhpcy50b3BTY29yZSlcclxuICAgICAgICAgICAgdGhpcy50b3BTY29yZSA9IHRoaXMuc2NvcmU7XHJcbiAgICB9XHJcbiAgICAvLyByZW1vdmVMaWZlKCkge1xyXG4gICAgLy8gICB0aGlzLmxpdmVzLS07XHJcbiAgICAvLyB9XHJcbiAgICBpbmNyZWFzZVNjb3JlKHBvaW50cykge1xyXG4gICAgICAgIHRoaXMuc2NvcmUgKz0gcG9pbnRzO1xyXG4gICAgfVxyXG4gICAgcmVzZXQoKSB7XHJcbiAgICAgICAgdGhpcy5saXZlcyA9IDM7XHJcbiAgICAgICAgdGhpcy5zY29yZSA9IDA7XHJcbiAgICB9XHJcbn1cclxuIiwiZXhwb3J0IGNsYXNzIE1lbW9yeUdhbWVWaWV3IHtcclxuICAgIGNvbnN0cnVjdG9yKGNvbnRhaW5lciwgbW9kZWwpIHtcclxuICAgICAgICB0aGlzLm1vZGVsID0gbW9kZWw7XHJcbiAgICAgICAgdGhpcy5jb250YWluZXIgPSBjb250YWluZXI7XHJcbiAgICB9XHJcbiAgICBkcmF3KCkge1xyXG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgdGhpcy5tb2RlbC5zaXplOyBpKyspIHtcclxuICAgICAgICAgICAgY29uc3Qgcm93ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImRpdlwiKTtcclxuICAgICAgICAgICAgcm93LmNsYXNzTmFtZSA9IFwiUm93XCI7XHJcbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHJvdyk7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy5tb2RlbC5zaXplOyBqKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGJ1dHRvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJidXR0b25cIik7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uY2xhc3NOYW1lID0gXCJUaWxlXCI7XHJcbiAgICAgICAgICAgICAgICBidXR0b24uaWQgPSBgQnV0dG9uJHtpICogdGhpcy5tb2RlbC5zaXplICsgan1gO1xyXG4gICAgICAgICAgICAgICAgLy9idXR0b24uZGlzYWJsZWQgPSB0cnVlO1xyXG4gICAgICAgICAgICAgICAgYnV0dG9uLm9uY2xpY2sgPSBhc3luYyAoKSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5ldmFsdWF0ZShidXR0b24sIGkgKiB0aGlzLm1vZGVsLnNpemUgKyBqKTtcclxuICAgICAgICAgICAgICAgIH07XHJcbiAgICAgICAgICAgICAgICByb3cuYXBwZW5kQ2hpbGQoYnV0dG9uKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBidXR0b24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gICAgICAgIGJ1dHRvbi5pbm5lckhUTUwgPSBcIlN0YXJ0XCI7XHJcbiAgICAgICAgYnV0dG9uLmNsYXNzTmFtZSA9IFwiU3RhcnRcIjtcclxuICAgICAgICBidXR0b24ub25jbGljayA9ICgpID0+IHtcclxuICAgICAgICAgICAgYnV0dG9uLmRpc2FibGVkID0gdHJ1ZTtcclxuICAgICAgICAgICAgdGhpcy5pbnRlcmFjdGFibGVUaWxlcyhcInRydWVcIik7XHJcbiAgICAgICAgICAgIHRoaXMuaW5pdGlhdGVHYW1lKCk7XHJcbiAgICAgICAgfTtcclxuICAgICAgICB0aGlzLmNvbnRhaW5lci5hcHBlbmRDaGlsZChidXR0b24pO1xyXG4gICAgICAgIGNvbnN0IHBsYXllckluZm8gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpO1xyXG4gICAgICAgIHBsYXllckluZm8uY2xhc3NOYW1lID0gXCJQbGF5ZXJJbmZvXCI7XHJcbiAgICAgICAgY29uc3QgcGxheWVyTmFtZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsYWJlbFwiKTtcclxuICAgICAgICBwbGF5ZXJOYW1lLmlubmVySFRNTCA9IHRoaXMubW9kZWwucGxheWVyLm5hbWU7XHJcbiAgICAgICAgcGxheWVyTmFtZS5jbGFzc05hbWUgPSBcIlBsYXllck5hbWVcIjtcclxuICAgICAgICBwbGF5ZXJJbmZvLmFwcGVuZENoaWxkKHBsYXllck5hbWUpO1xyXG4gICAgICAgIGNvbnN0IHBsYXllclNjb3JlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO1xyXG4gICAgICAgIHBsYXllclNjb3JlLmlubmVySFRNTCA9IHRoaXMubW9kZWwucGxheWVyLnNjb3JlLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgcGxheWVyU2NvcmUuY2xhc3NOYW1lID0gXCJQbGF5ZXJTY29yZVwiO1xyXG4gICAgICAgIHBsYXllckluZm8uYXBwZW5kQ2hpbGQocGxheWVyU2NvcmUpO1xyXG4gICAgICAgIGNvbnN0IHBsYXllclRvcFNjb3JlID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO1xyXG4gICAgICAgIHBsYXllclRvcFNjb3JlLmlubmVySFRNTCA9IHRoaXMubW9kZWwucGxheWVyLnRvcFNjb3JlLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgcGxheWVyVG9wU2NvcmUuY2xhc3NOYW1lID0gXCJQbGF5ZXJUb3BTY29yZVwiO1xyXG4gICAgICAgIHBsYXllckluZm8uYXBwZW5kQ2hpbGQocGxheWVyVG9wU2NvcmUpO1xyXG4gICAgICAgIGNvbnN0IHBsYXllckxpdmVzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImxhYmVsXCIpO1xyXG4gICAgICAgIHBsYXllckxpdmVzLmlubmVySFRNTCA9IHRoaXMubW9kZWwucGxheWVyLmxpdmVzLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgcGxheWVyTGl2ZXMuY2xhc3NOYW1lID0gXCJQbGF5ZXJMaXZlc1wiO1xyXG4gICAgICAgIHBsYXllckluZm8uYXBwZW5kQ2hpbGQocGxheWVyTGl2ZXMpO1xyXG4gICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHBsYXllckluZm8pO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgc2xlZXAobXMpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUpID0+IHNldFRpbWVvdXQocmVzb2x2ZSwgbXMpKTtcclxuICAgIH1cclxuICAgIGFzeW5jIGluaXRpYXRlR2FtZSgpIHtcclxuICAgICAgICBjb25zdCBpbmRleGVzID0gdGhpcy5tb2RlbC5zdGFydCgpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGluZGV4ZXMpO1xyXG4gICAgICAgIGF3YWl0IHRoaXMuc2xlZXAoMTAwMCk7XHJcbiAgICAgICAgaW5kZXhlcy5mb3JFYWNoKGFzeW5jIChpbmRleCkgPT4ge1xyXG4gICAgICAgICAgICBhd2FpdCB0aGlzLnNob3dUaWxlKGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGBCdXR0b24ke2luZGV4fWApKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuICAgIGFzeW5jIHNob3dUaWxlKHRpbGUpIHtcclxuICAgICAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG4gICAgICAgICAgICB0aWxlLmNsYXNzTGlzdC5hZGQoXCJBY3RpdmVUaWxlXCIpO1xyXG4gICAgICAgICAgICBzZXRUaW1lb3V0KGFzeW5jICgpID0+IHtcclxuICAgICAgICAgICAgICAgIHRpbGUuY2xhc3NMaXN0LnJlbW92ZShcIkFjdGl2ZVRpbGVcIik7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLnNsZWVwKDUwMCk7XHJcbiAgICAgICAgICAgICAgICByZXNvbHZlKG51bGwpO1xyXG4gICAgICAgICAgICB9LCA1MDApO1xyXG4gICAgICAgIH0pO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgZXZhbHVhdGUoYnV0dG9uLCBpbmRleCkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuc2hvd1RpbGUoYnV0dG9uKTtcclxuICAgICAgICBjb25zdCBvdXRjb21lID0gdGhpcy5tb2RlbC5ldmFsdWF0ZShpbmRleCk7XHJcbiAgICAgICAgc3dpdGNoIChvdXRjb21lKSB7XHJcbiAgICAgICAgICAgIGNhc2UgLTI6IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXJ0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5TdGFydFwiKTtcclxuICAgICAgICAgICAgICAgIHN0YXJ0LnNldEF0dHJpYnV0ZShcImVuYWJsZWRcIiwgXCJ0cnVlXCIpO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5pbnRlcmFjdGFibGVUaWxlcyhcImZhbHNlXCIpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhc2UgLTE6IHtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMubGV2ZWxOb3RDbGVhcmVkKCk7XHJcbiAgICAgICAgICAgICAgICBhd2FpdCB0aGlzLmRpc3BsYXlQYXR0ZXJuKCk7XHJcbiAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBjYXNlIDA6IHtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGNhc2UgMToge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgdGhpcy5sZXZlbENsZWFyZWQoKTtcclxuICAgICAgICAgICAgICAgIGF3YWl0IHRoaXMuZGlzcGxheVBhdHRlcm4oKTtcclxuICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMudXBkYXRlUGxheWVySW5mbygpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgZGlzcGxheVBhdHRlcm4oKSB7XHJcbiAgICAgICAgY29uc3QgaW5kZXhlcyA9IHRoaXMubW9kZWwudGlsZXM7XHJcbiAgICAgICAgY29uc29sZS5sb2coaW5kZXhlcyk7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5zbGVlcCgyMDAwKTtcclxuICAgICAgICBmb3IgKGNvbnN0IGluZGV4IG9mIGluZGV4ZXMpIHtcclxuICAgICAgICAgICAgYXdhaXQgdGhpcy5zaG93VGlsZShkb2N1bWVudC5nZXRFbGVtZW50QnlJZChgQnV0dG9uJHtpbmRleH1gKSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgaW50ZXJhY3RhYmxlVGlsZXModmFsdWUpIHtcclxuICAgICAgICBjb25zdCBidXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5UaWxlXCIpO1xyXG4gICAgICAgIGJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiBidXR0b24uc2V0QXR0cmlidXRlKFwiZW5hYmxlZFwiLCB2YWx1ZSkpO1xyXG4gICAgfVxyXG4gICAgdXBkYXRlUGxheWVySW5mbygpIHtcclxuICAgICAgICAvKmNvbnN0IHBsYXllck5hbWUgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuUGxheWVyTmFtZScpO1xyXG4gICAgICAgIHBsYXllck5hbWUuaW5uZXJIVE1MID0gdGhpcy5tb2RlbC5wbGF5ZXIubmFtZTsqL1xyXG4gICAgICAgIGNvbnN0IHBsYXllclNjb3JlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5QbGF5ZXJTY29yZVwiKTtcclxuICAgICAgICBwbGF5ZXJTY29yZS5pbm5lckhUTUwgPSB0aGlzLm1vZGVsLnBsYXllci5zY29yZS50b1N0cmluZygpO1xyXG4gICAgICAgIGNvbnN0IHBsYXllclRvcFNjb3JlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5QbGF5ZXJUb3BTY29yZVwiKTtcclxuICAgICAgICBwbGF5ZXJUb3BTY29yZS5pbm5lckhUTUwgPSB0aGlzLm1vZGVsLnBsYXllci50b3BTY29yZS50b1N0cmluZygpO1xyXG4gICAgICAgIGNvbnN0IHBsYXllckxpdmVzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5QbGF5ZXJMaXZlc1wiKTtcclxuICAgICAgICBwbGF5ZXJMaXZlcy5pbm5lckhUTUwgPSB0aGlzLm1vZGVsLnBsYXllci5saXZlcy50b1N0cmluZygpO1xyXG4gICAgfVxyXG4gICAgYXN5bmMgbGV2ZWxDbGVhcmVkKCkge1xyXG4gICAgICAgIGF3YWl0IHRoaXMuc2xlZXAoNTAwKTtcclxuICAgICAgICBjb25zdCBidXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbChcIi5UaWxlXCIpO1xyXG4gICAgICAgIGJ1dHRvbnMuZm9yRWFjaCgoYnV0dG9uKSA9PiBidXR0b24uY2xhc3NMaXN0LmFkZChcIkNsZWFyZWRcIikpO1xyXG4gICAgICAgIGF3YWl0IHRoaXMuc2xlZXAoMTAwMCk7XHJcbiAgICAgICAgYnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IGJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKFwiQ2xlYXJlZFwiKSk7XHJcbiAgICB9XHJcbiAgICBhc3luYyBsZXZlbE5vdENsZWFyZWQoKSB7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5zbGVlcCg1MDApO1xyXG4gICAgICAgIGNvbnN0IGJ1dHRvbnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLlRpbGVcIik7XHJcbiAgICAgICAgYnV0dG9ucy5mb3JFYWNoKChidXR0b24pID0+IGJ1dHRvbi5jbGFzc0xpc3QuYWRkKFwiTm90Q2xlYXJlZFwiKSk7XHJcbiAgICAgICAgYXdhaXQgdGhpcy5zbGVlcCgxMDAwKTtcclxuICAgICAgICBidXR0b25zLmZvckVhY2goKGJ1dHRvbikgPT4gYnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUoXCJOb3RDbGVhcmVkXCIpKTtcclxuICAgIH1cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9